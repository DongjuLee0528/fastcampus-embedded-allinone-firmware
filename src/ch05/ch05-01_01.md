# ATmega328p ADC (Analog to Digital Converter) 이론 정리

---

## 1. ADC란?

ADC(Analog to Digital Converter)는 아날로그 신호를 디지털 신호로 변환하는 장치다.

- **아날로그 신호**: 연속 시간선상에 표현된 신호
- **디지털 신호**: 0과 1로 표현된 신호
- 변환 과정: **표본화 → 양자화 → 부호화**

---

## 2. 표본화 (Sampling)

원신호를 얼마나 세밀하게 쪼갤 것인가를 결정하는 과정.

- 디지털 신호로 변환 시 샘플링할 주기를 결정
- **나이퀴스트 이론**: 샘플링 주파수는 원신호 주파수의 **2배 이상**이어야 한다

---

## 3. 나이퀴스트 (Nyquist) 이론

| 조건 | 결과 |
|------|------|
| fs > 2fm | 정상 변환 |
| fs = 2fm | 경계 조건 |
| fs < 2fm | Aliasing(왜곡) 발생, 신호값이 0이 될 수 있음 |

---

## 4. 양자화 (Quantization)

무한한 아날로그 정보를 셀 수 있는 간격으로 만드는 과정.

- 샘플링된 신호는 **양자화 오차**를 가진다
- 분해능이 높을수록 양자화 오차는 줄어든다
- 양자화 레벨은 Bit 수와 연관
  - ex) 12bit ADC → $2^{12}$ = **4096개** 양자화 레벨

---

## 5. 부호화 (Encoding)

양자화된 신호를 디지털 신호(0과 1)로 변환하는 최종 과정. 이 과정까지 완료되면 ADC 변환이 완료된다.

---

## 6. ATmega328p ADC 특징

| 항목 | 내용 |
|------|------|
| 분해능 | 10bit → 0 ~ 1023의 디지털 값 |
| 정확도 | ±2 LSB (Vref에 따라 다름, ex. 4Vref → 3.9062mV 오차) |
| 변환 시간 | 13 ~ 260μs |
| 샘플링 속도 | 최대 76.9kSPS (최대 분해능 시 15kSPS) |
| 채널 수 | 6개 (Single Ended 입력) |
| 입력 방식 | Single Ended (GND 기준) / Differential |
| 기준 전압 | 내부 1.1V Vref 설정 가능 |
| 동작 모드 | Free Running / Single Conversion |
| 기타 | ADC 변환 완료 인터럽트, Sleep Mode Noise Canceler |

---

## 7. ADC 계산 방법

$$ADC = \frac{V_{IN} \times 1024}{V_{REF}}$$

**예시**: Vref = 2.5V, Vin = 2V

$$ADC = \frac{2 \times 1024}{2.5} = 819 = \text{0x333}$$

역산 (실제 전압 계산):

$$V_{IN} = \frac{ADC \times V_{REF}}{1024}$$

- Vref는 설계 의도에 따라 내부 **1.1V ~ Vcc** 범위로 설정 가능

---

## 8. 핵심 요약

1. ADC는 아날로그 신호를 **표본화 → 양자화 → 부호화** 3단계로 디지털 신호로 변환한다.
2. 신호 왜곡 방지를 위해 **원신호 주파수의 2배 이상**으로 샘플링해야 한다 (나이퀴스트 이론).
3. ATmega328P는 **10비트 분해능**을 가지며, ADC 결과값과 기준 전압으로 실제 입력 전압을 계산할 수 있다.